"use strict";(self.webpackChunkspotify_api_usage_example=self.webpackChunkspotify_api_usage_example||[]).push([[143],{6202:(t,e,s)=>{s(6487);var a=s(538),n=s(4765),r=s.n(n),i=s(266),o=s(629),l=s(1463),c=s.n(l);const u=t=>{return"set"+`${(e=t)[0].toUpperCase()}${e.slice(1)}`;var e},d=t=>(e,s)=>{e[t]=s},m=t=>[u(t),d(t)],p=t=>Object.fromEntries(t.map(m)),h=Object.freeze({colorTheme:"light",systemTheme:null}),v={namespaced:!0,state:{...h},getters:{isDarkMode(t){const{colorTheme:e}=t;return"dark"===e||"auto"===e&&"dark"===t.systemTheme}},mutations:p(Object.keys(h))},f=Object.freeze({x:void 0}),_={namespaced:!0,state:{...f},mutations:{...p(Object.keys(f)),resetState(t){Object.assign(t,f)}}};var g=s(8345),y=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)};y._withStripped=!0;var k=s(1900),b=(0,k.Z)({},y,[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("main",{staticClass:"not-found-root"},[s("div",{staticClass:"not-found-text"},[t._v("\n    Page not found\n  ")])])}],!1,null,"28345dd6",null);b.options.__file="src/pages/NotFound/index.vue";const w=b.exports;var T=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("main",{staticClass:"login-root"},[s("form",{on:{submit:function(e){return e.preventDefault(),t.signIn.apply(null,arguments)}}},[s("LandingButton",{staticClass:"login-button",attrs:{type:"submit"}},[t._v("\n      Sign in via Spotify\n    ")])],1)])};T._withStripped=!0;var S=function(){var t=this,e=t.$createElement;return(t._self._c||e)("button",t._g(t._b({staticClass:"login-button",attrs:{type:t.type}},"button",t.$attrs,!1),t.$listeners),[t._t("default")],2)};S._withStripped=!0;const C={inheritAttrs:!1,props:{type:{type:String,default:"button"}}};var x=(0,k.Z)(C,S,[],!1,null,"486fcdea",null);x.options.__file="src/ui/LandingButton/index.vue";const E={components:{LandingButton:x.exports},methods:{...(0,o.nv)("auth",{signIn:"signIn"})}};var I=(0,k.Z)(E,T,[],!1,null,"2ddd9490",null);I.options.__file="src/pages/Login/index.vue";const L=I.exports;var M=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Layout",{scopedSlots:t._u([{key:"sidebar",fn:function(){return[s("div",{staticClass:"menu-container"},[s("div",{staticClass:"menu-top"},[s("ThemeSelector"),t._v(" "),s("ArtistsList",{attrs:{list:t.recentArtists,selectedId:t.selectedArtistId}})],1),t._v(" "),s("MenuFooter")],1)]},proxy:!0},{key:"content",fn:function(){return[s("div",{staticClass:"content-container"},[t.selectedArtistId?s("router-link",{staticClass:"unselect-link",attrs:{to:{query:{artist:void 0}}}},[t._v("\n        Display all artists\n      ")]):t._e(),t._v(" "),t.displayedTracks?s("fragment",[t.displayedTracks.length>0?s("ul",{staticClass:"track-grid"},t._l(t.displayedTracks,(function(t){return s("li",{key:t.track.id},[s("TrackCard",{attrs:{item:t}})],1)})),0):s("div",[t._v("\n          No tracks found\n        ")])]):t._e(),t._v(" "),s("div",[s("button",{attrs:{type:"button"},on:{click:t.onClickPrev}},[t._v("\n          Prev\n        ")]),t._v(" "),s("button",{attrs:{type:"button"},on:{click:t.onClickNext}},[t._v("\n          Next\n        ")])])],1)]},proxy:!0}])})};M._withStripped=!0;var O=s(5578),D=s.n(O),R=s(6033),P=s(3092);class $ extends Error{constructor(t){super(t),this.name="RequestError"}}class Z extends Error{constructor(t){super(t),this.name="UnauthorizedError"}}var A=s(6604),U=s.n(A),z=s(4293),j=s.n(z);const N=t=>{if(j()(t))return"";const e=U()(t,String);return new URLSearchParams(e).toString()};function B(t,e,s){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,s)}var F=new WeakMap;const q=new class{constructor(){B(this,F,{writable:!0,value:void 0})}setAccessToken(t){(0,P.Z)(this,F,t)}async requestJson(t,e){const s=e?`${t}?${N(e)}`:t,a=await fetch(s,{headers:{Authorization:`Bearer ${(0,R.Z)(this,F)}`}}),n=await a.json();if(a.ok)return n;if(401===a.status)throw new Z(n.error.message);throw new $(n.error.message)}getCurrentUser(){return this.requestJson("https://api.spotify.com/v1/me")}getRecentlyPlayedTracks(t){return this.requestJson("https://api.spotify.com/v1/me/player/recently-played",t)}};function W(t,e,s){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,s)}var Y=new WeakMap,H=new WeakMap;const J=new class{constructor(){W(this,Y,{writable:!0,value:void 0}),W(this,H,{writable:!0,value:void 0})}setRouter(t){(0,P.Z)(this,Y,t)}setStore(t){(0,P.Z)(this,H,t)}async handle(t){console.error(t),t instanceof Z&&((0,R.Z)(this,H).dispatch("auth/signOut"),await(0,R.Z)(this,Y).push({name:"login"})),a.default.notify({group:"global",title:"Error",text:t.message})}};var K=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"dashboard-root"},[s("Resize",{model:{value:t.isResizing,callback:function(e){t.isResizing=e},expression:"isResizing"}}),t._v(" "),s("div",{staticClass:"sidebar",style:{width:t.sideBarLeft}},[t._t("sidebar")],2),t._v(" "),s("main",{staticClass:"content",style:{"margin-left":t.sideBarLeft}},[t._t("content")],2)],1)};K._withStripped=!0;var G=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("fragment",[s("GlobalEvents",{on:{mousemove:function(e){return e.stopPropagation(),t.onMouseMove.apply(null,arguments)},mouseup:function(e){return e.stopPropagation(),t.onMouseUp.apply(null,arguments)}}}),t._v(" "),s("GlobalClassList",{attrs:{value:t.globalClass}}),t._v(" "),s("div",{staticClass:"resize-bar",style:{left:t.x},on:{mousedown:t.onMouseDown}})],1)};G._withStripped=!0;var X=s(4691),V=s.n(X),Q=s(8849),tt=s(7361),et=s.n(tt);const st={props:{value:String,target:{type:[String,Array],default:()=>["document","body"]}},computed:{targetClassList(){return et()(window,this.target).classList}},watch:{value(t,e){e&&this.targetClassList.remove(e),t&&this.targetClassList.add(t)},target(t,e){window[e].classList.remove(this.value),window[t].classList.add(this.value)}},mounted(){this.value&&this.targetClassList.add(this.value)},beforeDestroy(){this.value&&this.targetClassList.remove(this.value)},render:t=>t()},at={name:"Resize",components:{GlobalEvents:Q.Z,GlobalClassList:st},props:{value:Boolean},computed:{...(0,o.rn)("sidebar",["x"]),globalClass(){return this.value?"global-resizing":void 0}},methods:{...(0,o.OI)("sidebar",["setX","resetState"]),onMouseDown(){this.$emit("input",!0)},onMouseMove(t){if(!this.value)return;const e=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=Math.max(.1*e,225),a=.4*e,n=Math.round(V()(t.clientX,s,a));this.setX(`${n}px`)},onMouseUp(){this.$emit("input",!1)}}};var nt=(0,k.Z)(at,G,[],!1,null,"92dbdcb4",null);nt.options.__file="src/ui/Resize.vue";const rt={components:{Resize:nt.exports},data:()=>({isResizing:!1}),computed:{...(0,o.rn)("sidebar",{sideBarLeft:"x"})}};var it=(0,k.Z)(rt,K,[],!1,null,"50bf451c",null);it.options.__file="src/ui/Layout.vue";const ot=it.exports;var lt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"theme-selector-root"},[s("Radio",{attrs:{name:t.name,list:t.list,selected:t.colorTheme},on:{input:t.setColorTheme}})],1)};lt._withStripped=!0;const ct=()=>Math.random().toString(36).slice(2);var ut=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"radio-root"},t._l(t.list,(function(e){return s("label",{key:e.value,staticClass:"theme-item",class:{selected:e.value===t.selected}},[s("input",{attrs:{type:"radio",name:t.name},domProps:{value:e.value,checked:e.value===t.selected},on:{input:function(s){return t.$emit("input",e.value)}}}),t._v("\n    "+t._s(e.label)+"\n  ")])})),0)};ut._withStripped=!0;const dt={props:{name:String,list:Array,selected:String}};var mt=(0,k.Z)(dt,ut,[],!1,null,"e538135c",null);mt.options.__file="src/ui/ThemeSelector/Radio.vue";const pt={components:{Radio:mt.exports},data:()=>({name:ct(),list:[{value:"light",label:"Light theme"},{value:"dark",label:"Dark theme"},{value:"auto",label:"System theme"}]}),computed:{...(0,o.rn)("appearance",{colorTheme:"colorTheme"})},methods:{...(0,o.OI)("appearance",{setColorTheme:"setColorTheme"})}};var ht=(0,k.Z)(pt,lt,[],!1,null,"1fa4a7c9",null);ht.options.__file="src/ui/ThemeSelector/index.vue";const vt=ht.exports;var ft=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"artists-title"},[t._v("\n    Recently played artists:\n  ")]),t._v(" "),t.list?s("ul",{staticClass:"artist-list"},t._l(t.list,(function(e){return s("li",{key:e.id},[s("router-link",{staticClass:"artist-link",attrs:{to:{query:{artist:e.id}}}},[s("MenuItem",{attrs:{text:e.name,isSelected:e.id===t.selectedId}})],1)],1)})),0):t._e()])};ft._withStripped=!0;var _t=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"artist-item-root",class:{selected:t.isSelected}},[s("div",{staticClass:"name"},[t._v("\n    "+t._s(t.text)+"\n  ")])])};_t._withStripped=!0;const gt={props:{text:String,isSelected:Boolean}};var yt=(0,k.Z)(gt,_t,[],!1,null,"7f5f6d1e",null);yt.options.__file="src/pages/Dashboard/MenuItem.vue";const kt=yt.exports,bt={components:{MenuItem:kt},props:{list:Array,selectedId:String}};var wt=(0,k.Z)(bt,ft,[],!1,null,"e658eb8a",null);wt.options.__file="src/pages/Dashboard/ArtistsList.vue";const Tt=wt.exports;var St=function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("router-link",{staticClass:"logout-link",attrs:{to:{name:"logout"}}},[e("MenuItem",{attrs:{text:"Sign out"}})],1)],1)};St._withStripped=!0;const Ct={components:{MenuItem:kt},methods:{...(0,o.nv)("auth",{signOut:"signOut"})}};var xt=(0,k.Z)(Ct,St,[],!1,null,"09cac679",null);xt.options.__file="src/pages/Dashboard/MenuFooter.vue";const Et=xt.exports;var It=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"track-card-root"},[s("LazyImage",{staticClass:"track-image",attrs:{src:t.imageUrl}}),t._v(" "),s("div",{staticClass:"content"},[s("div",[s("div",{staticClass:"title"},[t._v("\n        "+t._s(t.item.track.name)+"\n      ")]),t._v(" "),s("div",[s("ul",t._l(t.item.track.artists,(function(e){return s("li",{key:e.id,staticClass:"artist"},[t._v("\n            "+t._s(e.name)+"\n          ")])})),0)])]),t._v(" "),s("div",[s("span",{staticClass:"played-at"},[t._v("\n        Played at: "+t._s(t.formattedPlayedAtTimestamp)+"\n      ")])])])],1)};It._withStripped=!0;var Lt=s(1384),Mt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.imageUrl?s("img",{attrs:{src:t.imageUrl}}):s("div",{staticClass:"dummy-div"})};Mt._withStripped=!0;const Ot={props:{src:String},data:()=>({imageUrl:void 0}),created(){this.preloadImage()},methods:{async preloadImage(){const t=await(t=>{const e=new Image;return new Promise(((s,a)=>{e.onload=()=>{s(e)},e.onerror=a,e.src=t}))})(this.src);this.imageUrl=t.src}}};var Dt=(0,k.Z)(Ot,Mt,[],!1,null,"4320da76",null);Dt.options.__file="src/ui/LazyImage.vue";const Rt={components:{LazyImage:Dt.exports},props:{item:Object},computed:{imageUrl(){return this.item.track.album.images[1].url},formattedPlayedAtTimestamp(){return(0,Lt.Z)(new Date(this.item.played_at),"dd MMM yyyy, HH:mm")}}};var Pt=(0,k.Z)(Rt,It,[],!1,null,"7d51262c",null);Pt.options.__file="src/pages/Dashboard/TrackCard.vue";const $t={components:{Layout:ot,ThemeSelector:vt,ArtistsList:Tt,MenuFooter:Et,TrackCard:Pt.exports},data:()=>({timer:null,recentlyPlayedTracks:null}),computed:{selectedArtistId(){return this.$route.query.artist},recentArtists(){const{recentlyPlayedTracks:t}=this;if(!t)return null;const e=null==t?void 0:t.flatMap((t=>t.track.artists));return D()(e,"id")},displayedTracks(){const{recentlyPlayedTracks:t}=this;if(!t)return null;const{selectedArtistId:e}=this;return e?t.filter((t=>t.track.artists.some((t=>t.id===e)))):t}},created(){this.repeatLoadData()},beforeDestroy(){clearTimeout(this.timer)},methods:{async repeatLoadData(){await this.loadRecentlyPlayedTracks(),this.timer=setTimeout(this.repeatLoadData,3e4)},async loadRecentlyPlayedTracks(){try{const t=await q.getRecentlyPlayedTracks({limit:20});this.recentlyPlayedTracks=t.items}catch(t){J.handle(t)}},onClickPrev(){console.log("prev")},onClickNext(){console.log("next")}}};var Zt=(0,k.Z)($t,M,[],!1,null,"fe23c5ba",null);Zt.options.__file="src/pages/Dashboard/index.vue";const At=[{path:"/",component:Zt.exports,beforeEnter:(t,e,s)=>{if(Jt().state.auth.accessToken)s();else{const e=t.fullPath;s({name:"login",query:{redirect:"/"!==e&&e||void 0}})}}},{path:"/login",name:"login",component:L,beforeEnter:(t,e,s)=>{Jt().state.auth.accessToken?s("/"):s()}},{path:"/logout",name:"logout",beforeEnter:(t,e,s)=>{Jt().dispatch("auth/signOut"),s({name:"login",params:{logout:!0}})}},{path:"*",component:w,meta:{resetTheme:!0}}];a.default.use(g.Z);const Ut=new g.Z({routes:At,scrollBehavior:(t,e,s)=>s||(t.hash?{selector:t.hash}:t.name!==e.name?{x:0,y:0}:void 0)}),{SPOTIFY_AUTH_HOST:zt,SPOTIFY_CLIENT_ID:jt,SPOTIFY_REDIRECT_URI:Nt}={NODE_ENV:"production",VERSION:"v1.0.0",SPOTIFY_AUTH_HOST:"https://accounts.spotify.com/authorize",SPOTIFY_CLIENT_ID:"e900798eba474a8c8ac4c4373b175d7c",SPOTIFY_REDIRECT_URI:"https://inker.github.io/spotify-api-usage-example"},Bt=Object.freeze({stateKey:void 0,accessToken:void 0,userData:void 0}),Ft={namespaced:!0,state:{...Bt},mutations:p(Object.keys(Bt)),actions:{async refreshUserData(t){let{commit:e}=t;e("setUserData",await q.getCurrentUser())},signOut(t){let{commit:e}=t;e("setAccessToken",void 0),e("setUserData",null)},signIn(t){let{commit:e}=t;const s=ct();e("setStateKey",s);const a=N({response_type:"token",client_id:jt,scope:"user-read-recently-played",redirect_uri:Nt,state:s});window.location=`${zt}?${a}`},async restoreSession(t){let{commit:e,dispatch:s,state:a}=t;try{const{search:t,hash:n}=window.location;if(t){const e=new URLSearchParams(t).get("error");if(e){throw new Error("access_denied"===e?"Access denied":e)}}const r=new URLSearchParams(n.slice(2)),i=r.get("access_token");if(i){const t=r.get("state");if(i&&(!t||t!==a.stateKey))throw new Z("Error during authentication");if(e("setStateKey",void 0),!i)return;e("setAccessToken",i),q.setAccessToken(i),await s("refreshUserData"),await Ut.push("/")}else{const{accessToken:t}=a;q.setAccessToken(t),await s("refreshUserData")}}catch(t){J.handle(t)}}}},qt=Object.freeze({position:null,items:[]}),Wt={namespaced:!0,state:{...qt},mutations:{...p(Object.keys(qt)),resetState(t){Object.assign(t,qt)}},actions:{show(t,e){let{commit:s}=t,{items:a,mouseEvent:n}=e;s("setItems",a),s("setPosition",[n.clientX,n.clientY])},reset(t){let{commit:e}=t;e("resetState")}}};var Yt=s(4702);const Ht=(t,e)=>(0,Yt.Z)({key:`vuex:${t}`,paths:(null==e?void 0:e.map((e=>[t,e].join("."))))??[t],filter:e=>e.type.startsWith(`${t}/`),getState:(e,s)=>{const a=s.getItem(e);try{const e=JSON.parse(a);return e?{[t]:e}:{}}catch{return{}}},setState:(e,s,a)=>{a.setItem(e,JSON.stringify(s[t]))}}),Jt=c()((()=>{const t=new o.yh({modules:{appearance:v,sidebar:_,auth:Ft,contextMenu:Wt},plugins:[Ht("auth",["stateKey","accessToken"]),Ht("appearance",["colorTheme"]),Ht("sidebar"),Ht("dateTime")]});return(t=>{t.watch((t=>t.auth.accessToken),(t=>{t||a.default.notify({clean:!0})}))})(t),t}));var Kt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app-root"},[s("Theming"),t._v(" "),s("notifications",{attrs:{group:"global"}}),t._v(" "),s("router-view")],1)};Kt._withStripped=!0;const Gt=window.matchMedia("(prefers-color-scheme: dark)"),Xt={components:{Theming:{computed:{...(0,o.Se)("appearance",{isDarkMode:"isDarkMode"})},watch:{isDarkMode:{immediate:!0,handler(t){document.body.classList[t?"add":"remove"]("dark-mode")}}},mounted(){this.setSystemTheme(Gt.matches),Gt.addEventListener("change",this.handleMatchMediaChange)},beforeDestroy(){document.body.classList.remove("dark-mode"),Gt.removeEventListener("change",this.handleMatchMediaChange)},methods:{...(0,o.OI)("appearance",["setSystemTheme"]),handleMatchMediaChange(t){this.setSystemTheme(t.matches?"dark":"light")}},render:t=>t()}}};var Vt=(0,k.Z)(Xt,Kt,[],!1,null,"3689a55b",null);Vt.options.__file="src/Root.vue";const Qt=Vt.exports,te=s.e(872).then(s.t.bind(s,3119,23));a.default.config.productionTip=!1,a.default.use(o.ZP),a.default.use(i.Sy),a.default.use(r()),J.setRouter(Ut);const ee=Jt();J.setStore(ee),async function(){await te,await ee.dispatch("auth/restoreSession"),new a.default({el:"#app",components:{Root:Qt},store:ee,router:Ut,template:"<Root/>"})}()}},t=>{t.O(0,[421,485,202,284,736],(()=>{return e=6202,t(t.s=e);var e}));t.O()}]);